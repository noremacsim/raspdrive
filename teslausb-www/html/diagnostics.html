<html><head><title>TeslaUSB</title></head>
<body>
<iframe id="cgiframe" type="text/plain" src="cgi-bin/diagnose.sh" style="width:0;height:0;border:0"></iframe>

<div id="wait">Please wait, gathering diagnostics...</div>

<div id="afterload" style="display:block; visibility:hidden;">
<iframe id="diagnosticsframe" type="text/plain" width="900" height="500" border="1"></iframe>
<p>
<a id="dl" href="diagnostics.txt" download="diagnostics.txt">Download diagnostics</a>
<p>
</div>

<script>
var myIframe = document.getElementById('cgiframe');
myIframe.onload = function () {
    console.log('onload called');

    var df=document.getElementById('diagnosticsframe');
    df.src='diagnostics.txt';

    var waitdiv=document.getElementById('wait');
    waitdiv.style.visibility='hidden'

    var aldiv=document.getElementById('afterload');
    aldiv.style.visibility='visible'
}
</script>
</body>
</html>
